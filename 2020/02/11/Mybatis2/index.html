<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Gemini","version":"7.7.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":-1,"unescape":"ture","preload":"ture"},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="一.Mybatis简介1.mybatis是一个半自动化的持久性框架，将SQL语句和java编码分离，SQL语句的编写，优化由开发人员负责。  下载链接： https:&#x2F;&#x2F;github.com&#x2F;mybatis&#x2F;mybatis-3&#x2F;releases  二.IDEA创建mybatis项目1.项目创建 接口式编程推荐使用接口试编程 目录结构：   新建项目-maven-选择maven库（有maven库的前">
<meta property="og:type" content="article">
<meta property="og:title" content="Mybatis学习">
<meta property="og:url" content="http://yoursite.com/2020/02/11/Mybatis2/index.html">
<meta property="og:site_name" content="‘小伙子的博客">
<meta property="og:description" content="一.Mybatis简介1.mybatis是一个半自动化的持久性框架，将SQL语句和java编码分离，SQL语句的编写，优化由开发人员负责。  下载链接： https:&#x2F;&#x2F;github.com&#x2F;mybatis&#x2F;mybatis-3&#x2F;releases  二.IDEA创建mybatis项目1.项目创建 接口式编程推荐使用接口试编程 目录结构：   新建项目-maven-选择maven库（有maven库的前">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/1581423288477.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/1581487706718.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/1581431644608.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/1581432068970.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/1581519510957.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/1581598646572.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/1581686231443.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/1581685825405.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/C:%5CUsers%5Czhixia%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1582290567085.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/C:%5CUsers%5Czhixia%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1582290777294.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/1582297068104.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/1582297135413.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593412601501.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593415666820.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593594856661.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593594651522.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593605779361.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593605767592.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593605813798.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593608766117.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593680681385.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593680733679.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593350704119.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593350987235.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593351162924.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593355236184.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593355267074.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593695116298.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593782780298.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593782979585.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593783066611.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1594696496143.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1594697548587.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1594719721573.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1594730845256.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1594731656505.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1594731691831.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1594732420990.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1594804904720.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1594819367042.png">
<meta property="og:image" content="http://yoursite.com/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1594822620064.png">
<meta property="article:published_time" content="2020-02-11T07:13:47.000Z">
<meta property="article:modified_time" content="2020-09-11T08:36:27.816Z">
<meta property="article:author" content="’小伙子">
<meta property="article:tag" content="author-czx">
<meta property="article:tag" content="Mybatis">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/2020/02/11/Mybatis2/1581423288477.png">

<link rel="canonical" href="http://yoursite.com/2020/02/11/Mybatis2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true
  };
</script>

  <title>Mybatis学习 | ‘小伙子的博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">‘小伙子的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/ChenZhixia-stu" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/11/Mybatis2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/66.jpg">
      <meta itemprop="name" content="’小伙子">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="‘小伙子的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Mybatis学习
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-02-11 15:13:47" itemprop="dateCreated datePublished" datetime="2020-02-11T15:13:47+08:00">2020-02-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-11 16:36:27" itemprop="dateModified" datetime="2020-09-11T16:36:27+08:00">2020-09-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/czx/" itemprop="url" rel="index">
                    <span itemprop="name">czx</span>
                  </a>
                </span>
            </span>

          
            <span id="/2020/02/11/Mybatis2/" class="post-meta-item leancloud_visitors" data-flag-title="Mybatis学习" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="一-Mybatis简介"><a href="#一-Mybatis简介" class="headerlink" title="一.Mybatis简介"></a>一.Mybatis简介</h1><p>1.mybatis是一个半自动化的持久性框架，将SQL语句和java编码分离，SQL语句的编写，优化由开发人员负责。</p>
<p><img src="/2020/02/11/Mybatis2/1581423288477.png" alt="1581423288477"></p>
<p>下载链接： <a href="https://github.com/mybatis/mybatis-3/releases" target="_blank" rel="noopener">https://github.com/mybatis/mybatis-3/releases</a> </p>
<h1 id="二-IDEA创建mybatis项目"><a href="#二-IDEA创建mybatis项目" class="headerlink" title="二.IDEA创建mybatis项目"></a>二.IDEA创建mybatis项目</h1><h2 id="1-项目创建-接口式编程"><a href="#1-项目创建-接口式编程" class="headerlink" title="1.项目创建 接口式编程"></a>1.项目创建 接口式编程</h2><p>推荐使用接口试编程</p>
<p><strong>目录结构：</strong></p>
<img src="/2020/02/11/Mybatis2/1581487706718.png" alt="1581487706718" style="zoom:80%;">

<p>新建项目-maven-选择maven库（有maven库的前提下）</p>
<p><img src="/2020/02/11/Mybatis2/1581431644608.png" alt="1581431644608"></p>
<h2 id="2-配置文件"><a href="#2-配置文件" class="headerlink" title="2.配置文件"></a>2.配置文件</h2><h3 id="1-在pom-xml文件中添加依赖，build"><a href="#1-在pom-xml文件中添加依赖，build" class="headerlink" title="1.在pom.xml文件中添加依赖，build"></a><strong>1.在pom.xml文件中添加依赖，build</strong></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">       &lt;!--打印日志文件--&gt;</span><br><span class="line">     &lt;groupId&gt;log4j&lt;/groupId&gt;</span><br><span class="line">     &lt;artifactId&gt;log4j&lt;/artifactId&gt;</span><br><span class="line">     &lt;version&gt;1.2.16&lt;/version&gt;</span><br><span class="line">   &lt;/dependency&gt;</span><br><span class="line">       &lt;!--mysql数据驱动--&gt;</span><br><span class="line">   &lt;dependency&gt;</span><br><span class="line">     &lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class="line">     &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class="line">     &lt;version&gt;8.0.13&lt;/version&gt;</span><br><span class="line">   &lt;/dependency&gt;</span><br><span class="line">       &lt;!--mybatis核心jar--&gt;</span><br><span class="line">   &lt;dependency&gt;</span><br><span class="line">     &lt;groupId&gt;org.mybatis&lt;/groupId&gt;</span><br><span class="line">     &lt;artifactId&gt;mybatis&lt;/artifactId&gt;</span><br><span class="line">     &lt;version&gt;3.4.1&lt;/version&gt;</span><br><span class="line">   &lt;/dependency&gt;</span><br><span class="line">       </span><br><span class="line">       </span><br><span class="line">       &lt;build&gt;</span><br><span class="line">   &lt;resources&gt;</span><br><span class="line">     &lt;resource&gt;</span><br><span class="line">       &lt;directory&gt;src/main/java&lt;/directory&gt;</span><br><span class="line">       &lt;includes&gt;</span><br><span class="line">         &lt;include&gt;**<span class="comment">/*.xml&lt;/include&gt;</span></span><br><span class="line"><span class="comment">       &lt;/includes&gt;</span></span><br><span class="line"><span class="comment">     &lt;/resource&gt;</span></span><br><span class="line"><span class="comment">     &lt;resource&gt;</span></span><br><span class="line"><span class="comment">       &lt;directory&gt;src/main/resources&lt;/directory&gt;</span></span><br><span class="line"><span class="comment">       &lt;includes&gt;</span></span><br><span class="line">         &lt;include&gt;**/*.xml&lt;/include&gt;</span><br><span class="line">         &lt;include&gt;**<span class="comment">/*.properties&lt;/include&gt;</span></span><br><span class="line"><span class="comment">       &lt;/includes&gt;</span></span><br><span class="line"><span class="comment">     &lt;/resource&gt;</span></span><br><span class="line"><span class="comment">   &lt;/resources&gt;</span></span><br><span class="line"><span class="comment"> &lt;/build&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-log4j日志添加"><a href="#2-log4j日志添加" class="headerlink" title="2.log4j日志添加"></a><strong>2.log4j日志添加</strong></h3><p>在src/main/resources 资源包下添加<strong>log4j.properties</strong>文件，resource文件与java蓝色文件同级 。</p>
<p>如果java文件不是蓝色，将其标记为源码文件即可</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># Global logging configuration log4j.rootLogger=DEBUG, stdout #Consoleoutput... log4j.appender.stdout=org.apache.log4j.ConsoleAppender log4j.appender.stdout.layout=org.apache.log4j.PatternLayout log4j.appender.stdout.layout.ConversionPattern=%5p [%t] - %m%n</span><br></pre></td></tr></table></figure>

<p><img src="/2020/02/11/Mybatis2/1581432068970.png" alt="1581432068970"></p>
<h3 id="3-resource目录下配置文件添加"><a href="#3-resource目录下配置文件添加" class="headerlink" title="3.resource目录下配置文件添加"></a><strong>3.resource目录下配置文件添加</strong></h3><p><strong>mybatis.xml</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--加载驱动--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.cj.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--数连接据库--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/mybatis?characterEncoding=utf-8<span class="symbol">&amp;amp;</span>serverTimezone=UTC<span class="symbol">&amp;amp;</span>useSSL=false"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"123456789"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--将我们写好的sql映射文件一定要注册到全局配置文件中，可以复制相对路径填进去--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/ecjtu/mapper/UserMapper.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-编写User实体类"><a href="#4-编写User实体类" class="headerlink" title="4.编写User实体类"></a>4.编写User实体类</h3><p>根据数据库中信息编写，有什么列就写几个属性</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;        <span class="keyword">return</span> id;    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;        <span class="keyword">this</span>.id = id;    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;        <span class="keyword">return</span> name;    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;        <span class="keyword">this</span>.name = name;    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getGender</span><span class="params">()</span> </span>&#123;        <span class="keyword">return</span> gender;    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setGender</span><span class="params">(String gender)</span> </span>&#123;        <span class="keyword">this</span>.gender = gender;    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getEmail</span><span class="params">()</span> </span>&#123;       <span class="keyword">return</span> email;    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEmail</span><span class="params">(String email)</span> </span>&#123;        <span class="keyword">this</span>.email = email;    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"User&#123;"</span> + <span class="string">"id="</span> + id + <span class="string">", name='"</span> + name + <span class="string">'\''</span> +</span><br><span class="line">        <span class="string">", gender='"</span> + gender + <span class="string">'\''</span> + <span class="string">", email='"</span> + email + <span class="string">'\''</span> + <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-SQL映射文件UserMapper-xml"><a href="#5-SQL映射文件UserMapper-xml" class="headerlink" title="5.SQL映射文件UserMapper.xml"></a>5.SQL映射文件UserMapper.xml</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.ecjtu.mapper.UserMapper"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">namespace：名称空间，指定为接口的全类名</span></span><br><span class="line"><span class="comment">id:唯一标识符，与接口中的方法名要一致</span></span><br><span class="line"><span class="comment">resultType:返回值类型,可复制User的相对路径</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryUserById"</span> <span class="attr">resultType</span>=<span class="string">"com.ecjtu.User.User"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">        select * from user where id=#&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="6-编写接口UserMapper"><a href="#6-编写接口UserMapper" class="headerlink" title="6.编写接口UserMapper"></a>6.编写接口UserMapper</h3><p>编写映射文件中的接口，要与id名字一样</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">    <span class="function">User <span class="title">queryUserById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-测试"><a href="#7-测试" class="headerlink" title="7.测试"></a>7.测试</h3><p>具体操作在代码块中注释，Resources.getResourceAsStream要选择apache的，不能选择javax的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//1.获取配置资源文件</span></span><br><span class="line">        InputStream inputStream= Resources.getResourceAsStream(<span class="string">"mybatis.xml"</span>);</span><br><span class="line">        <span class="comment">//2.获取SqlSessionFactory对象，并将资源文件注入</span></span><br><span class="line">        SqlSessionFactory factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        <span class="comment">//3.获取sqlSession对象，能直接执行已经映射的sql语句</span></span><br><span class="line">        SqlSession sqlSession = factory.openSession();</span><br><span class="line">        <span class="comment">//4.根据SqlSession，获取接口的实现类对象</span></span><br><span class="line">        <span class="comment">//会为接口自动创建一个代理对象，代理对象去执行增删改查方法</span></span><br><span class="line">        <span class="comment">//UserMapper.class是接口类</span></span><br><span class="line">        UserMapper mapper = sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        User user = mapper.queryUserById(<span class="number">2</span>);</span><br><span class="line"><span class="comment">//        System.out.println(mapper);//org.apache.ibatis.binding.MapperProxy@71623278</span></span><br><span class="line">        System.out.println(user);</span><br><span class="line">        sqlSession.close();<span class="comment">//用完记得关闭</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="8-小结"><a href="#8-小结" class="headerlink" title="8.小结"></a>8.小结</h3><p>​    1.接口式编程</p>
<p>​    mybatis:    xxMapper==&gt;  xxMapper.xml      xxMapper接口有一个与之对应的xxMapper.xml  配置文件，该    配置文件相当于对xxMapper接口的实现。</p>
<ol start="2">
<li><p>SqlSession代表和数据库的一次会话，用完关闭</p>
</li>
<li><p>SqlSession和connection一样是非线程安全，不能定义为  private SqlSession sqlsession 成员变量。每次使用都应该去获取新的对象</p>
</li>
<li><p>Mapper接口没有实现类，但是mybatis会为这个接口生成一个代理对象，将Mappper接口和Mapper.xml进行绑定    UserMapper mapper = sqlSession.getMapper(UserMapper.class)；</p>
</li>
<li><p>两个重要的配置文件：①mybatis.xml全局配置文件：包含数据库连接池，事务管理器等系统运行环境。</p>
<p>​                                      ②sql的mapper.xml映射文件：保存了每一个SQL语句的映射信息。</p>
</li>
</ol>
<h1 id="三-mybatis-xml全局配置文件"><a href="#三-mybatis-xml全局配置文件" class="headerlink" title="三.mybatis.xml全局配置文件"></a>三.mybatis.xml全局配置文件</h1><h2 id="1-properties（了解）"><a href="#1-properties（了解）" class="headerlink" title="1.properties（了解）"></a>1.properties（了解）</h2><p>1.mybatis可以使用<strong>properties标签</strong>来引入外部properties配置文件的内容,properties标签中包括resource和url两个属性。</p>
<p>​    <strong>resource</strong>:引入类路径下的资源；</p>
<p>​    <strong>url</strong>：引入网络或磁盘路径下的资源；</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"dbconfig.properties"</span> &gt;</span><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2.刚开始我们是将jdbc的 driver，url ,  username，password 都写在mybatis.xml配置文件中<property>的value后，现在可以将其写在外部文件<strong>dbconfig.properties</strong>(放在resources资源文件下)中，在这里遇到一个错误：<a href="https://www.cnblogs.com/yongdongma/p/9911393.html" target="_blank" rel="noopener">https://www.cnblogs.com/yongdongma/p/9911393.html</a> （已解决）</property></p>
<p><strong>dbconfig.properties：</strong></p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">jdbc.driver=com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="xml">jdbc.url=jdbc:mysql://localhost:3306/mybatis?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false&amp;serverTimezone = GMT</span></span><br><span class="line"><span class="xml">jdbc.username=root</span></span><br><span class="line"><span class="xml">jdbc.password=123456789</span></span><br></pre></td></tr></table></figure>

<p>3.在将<property>标签中的value改为value=”${jdbc.xxx}”，改完之后运行看是否报错。</property></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--引用外部资源--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"dbconfig.properties"</span> &gt;</span><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"jdbc"</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 配置数据库连接信息 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"pooled"</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--在引入外部资源文件（dbconfig.properties）后，value后的值要与外部文件中的值的名字相对应--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--将我们写好的sql映射文件一定要注册到全局配置文件中--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/ecjtu/mapper/UserMapper.xml"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="2-settings设置"><a href="#2-settings设置" class="headerlink" title="2.settings设置"></a>2.settings设置</h2><p>1.这是MyBatis中极为重要的调整设置，它会改变MyBatis的运行行为。</p>
<p>2.settings包含很多重要的设置项，这里只取驼峰命名法设置项 <strong>mapUnderscoreToCamelCase</strong>，其默认值是        false，这里设置为true，开启驼峰命名法。</p>
<p>数据库不区分大小写，单词间要加下划线，而java中区分大小写，命名规范是驼峰命名法。  </p>
<p>  <strong>setting</strong>：用来设置每一个设置项</p>
<p>  <strong>name</strong>：设置项名  value:设置项取值</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--settings标签放在configuration标签中，其中可以设置多个设置项--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"mapUnderscoreToCamelCase"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"xxxxx"</span> <span class="attr">value</span>=<span class="string">"xxxx"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="3-typeAliases别名处理器"><a href="#3-typeAliases别名处理器" class="headerlink" title="3.typeAliases别名处理器"></a><strong>3.typeAliases别名</strong>处理器</h2><p><strong>typeAliases</strong>别名处理器：可以为java类型起别名, 减少类完全限定名的冗余(也就是简化返回值类型的拼写) 。其中typeAlias标签中包括type和alias两个属性：<br>       <strong>type</strong>:指定要起别名的类全类名（可复制相对路径，但记得把 <strong>/</strong> 改成 <strong>.</strong> ），默认别名是类名小写（user）；</p>
<p>​       <strong>alias</strong>:指定别名；</p>
<p><strong>注意：别名不区分大小写</strong>，所以user，User都可以。</p>
<h3 id="1-单个起别名"><a href="#1-单个起别名" class="headerlink" title="1.单个起别名"></a>1.单个起别名</h3><p>单个起别名由于idea不写alias会报红，但也能编译通过，所以还是写alias指定命名为us</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--在mybatis.xml全局配置文件中起了别名，就要在xxxMapper,xml  sql映射文件中修改resultType返回值类型，修改为别名 user</span></span><br><span class="line"><span class="comment">1.单个起别名</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">type</span>=<span class="string">"com.ecjtu.User.User"</span> <span class="attr">alias</span>=<span class="string">"us"</span>&gt;</span><span class="tag">&lt;/<span class="name">typeAlias</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--在xxxMapper.xml中修改--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryUserById"</span> <span class="attr">resultType</span>=<span class="string">"us"</span>&gt;</span></span><br><span class="line">        select * from user where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-批量起别名"><a href="#2-批量起别名" class="headerlink" title="2.批量起别名"></a>2.批量起别名</h3><p> package：为某个包下的所有类批量起别名<br> name:指定包名（当前包以及下面所有的后代包的每一个类都起一个默认别名（类名小写））</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.ecjtu.User"</span>&gt;</span><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在mybatis.xml配置文件中用批量起别名都是默认别名，xxxMapper.xmlsql映射文件中的 <strong>resultType</strong>=“类名小写” 。</p>
<h3 id="3-别名注解"><a href="#3-别名注解" class="headerlink" title="3.别名注解"></a>3.别名注解</h3><p><strong>前提：批量起别名的情况下</strong>，如果类名重复，可以使用@Alias注解为某个类指定新的别名</p>
<p> 在没有注解的情况下，会使用 类的首字母小写的非限定类名来作为它的别名。 比如 <code>User.java</code> 的别名为 <code>user</code>；若有注解，则别名为其注解值author</p>
<p>当然别名也可以@Alias（“xxx随便”）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Alias</span>(<span class="string">"author"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Author</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 这是一些为常见的 Java 类型内建的相应的类型别名。它们都是不区分大小写的，注意对基本类型名称重复采取的特殊命名风格。 我们起的别名不能跟下表中的别名重复</p>
<p><img src="/2020/02/11/Mybatis2/1581519510957.png" alt="1581519510957"></p>
<h2 id="4-typeHandlers-类型处理器（后补）"><a href="#4-typeHandlers-类型处理器（后补）" class="headerlink" title="4.typeHandlers 类型处理器（后补）"></a>4.typeHandlers 类型处理器（后补）</h2><h2 id="5-plugin插件（后补）"><a href="#5-plugin插件（后补）" class="headerlink" title="5.plugin插件（后补）"></a>5.plugin插件（后补）</h2><p>MyBatis 允许你在已映射语句执行过程中的某一点进行拦截调用。默认情况下，MyBatis 允许使用插件来拦截的方法调用包括：</p>
<ul>
<li>Executor (update, query, flushStatements, commit, rollback, getTransaction, close, isClosed)</li>
<li>ParameterHandler (getParameterObject, setParameters)</li>
<li>ResultSetHandler (handleResultSets, handleOutputParameters)</li>
<li>StatementHandler (prepare, parameterize, batch, update, query)</li>
</ul>
<p>这些类中方法的细节可以通过查看每个方法的签名来发现，或者直接查看 MyBatis 发行包中的源代码。 如果你想做的不仅仅是监控方法的调用，那么你最好相当了解要重写的方法的行为。 因为如果在试图修改或重写已有方法的行为的时候，你很可能在破坏 MyBatis 的核心模块。 这些都是更低层的类和方法，所以使用插件的时候要特别当心。</p>
<h2 id="6-environments环境配置（了解）"><a href="#6-environments环境配置（了解）" class="headerlink" title="6.environments环境配置（了解）"></a>6.environments环境配置（了解）</h2><p>Mybatis可以配置多种环境，environment配置一个具体的环境信息，必须有两个标签<transactionManager>和<dataSource></dataSource></transactionManager></p>
<p><strong>1.transactionManager</strong>：事务管理器；</p>
<p>​        <strong>type</strong>:事务管理器类型，包括 JDBC  |  MANAGED.也可以自定义事务管理器,实现TransactionFactory接口，type指定为全类名，了解即可。</p>
<p>​        <strong>提示</strong>：如果你正在使用 Spring + MyBatis，则没有必要配置事务管理器， 因为 Spring 模块会使用自带的管理器来覆盖前面（mybatis）的配置。 </p>
<p><strong>2.dateSource</strong>数据源：</p>
<p>​        <strong>type</strong>:数据源类型 ；有三种内建的数据源类型（也就是 type=”[UNPOOLED|POOLED|JNDI]”）： </p>
<p><strong>default</strong>：指定某种环境，可以快速切换环境</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"xxx(填id的值)"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--id代表当前环境的唯一标识--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"xxx"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"jdbc"</span>&gt;</span><span class="tag">&lt;/<span class="name">transactionManager</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span><span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environment</span>&gt;</span> </span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>最后会使用spring-mybatis整合,所以这里了解即可</p>
<h2 id="7-databaseIdProvider数据库厂商标识"><a href="#7-databaseIdProvider数据库厂商标识" class="headerlink" title="7.databaseIdProvider数据库厂商标识"></a>7.databaseIdProvider数据库厂商标识</h2><p>databaesIdProvider:支持多数据库厂商。<br>type=”DB_VENDOR”：VendorDatabaseIdProvider， 作用是得到数据库厂商的标识，mybatis就能根据数据库厂商标识来执行不同的sql 。</p>
<p>数据库厂商：MySQL,Oracle,SQL Server ….</p>
<h3 id="1-为不同厂商的数据库起别名"><a href="#1-为不同厂商的数据库起别名" class="headerlink" title="1.为不同厂商的数据库起别名"></a>1.为不同厂商的数据库起别名</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">databaseIdProvider</span> <span class="attr">type</span>=<span class="string">"DB_VENDOR"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--为不同数据厂商起别名  MySql取别名为mysql--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"MySql"</span> <span class="attr">value</span>=<span class="string">"mysql"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"Oracle"</span> <span class="attr">value</span>=<span class="string">"oracle"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"SQL Server"</span> <span class="attr">value</span>=<span class="string">"sqlserver"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">databaseIdProvider</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>为数据库起完别名后，要在sql映射文件（xxMapper.xml）中配置相应的数据库</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--databaseId=“mysql”  表示此条SQL语句只在mysql环境下才使用--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryUserById"</span> <span class="attr">resultType</span>=<span class="string">"121"</span>  <span class="attr">databaseId</span>=<span class="string">"mysql"</span>&gt;</span></span><br><span class="line">     select * from user where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-切换环境测试"><a href="#2-切换环境测试" class="headerlink" title="2.切换环境测试"></a>2.切换环境测试</h3><p>1.mybatis中对SQLServer数据库进行操作，修改相应的信息后，记得导入SQLServer数据库专用的jar包，</p>
<p><img src="/2020/02/11/Mybatis2/1581598646572.png" alt="1581598646572"></p>
<p><strong>注意：databaseIdProvider</strong>这个标签一定要放在<strong>environments</strong>标签后，下面是各标签顺序，某个标签可以没有，但顺序不能变。</p>
<p><img src="/2020/02/11/Mybatis2/1581686231443.png" alt="1581686231443"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"SQLServer（对应id）"</span>&gt;</span>      </span><br><span class="line">    <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"SQLServer（这个id随便取）"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"jdbc"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"pooled"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.microsoft.sqlserver.jdbc.SQLServerDriver"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:sqlserver://127.0.0.1:1433;databaseName=java课设"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"javakeshe"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"123456"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"mysql"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"jdbc"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"pooled"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--4.databaesIdProvider:支持多数据库厂商</span></span><br><span class="line"><span class="comment">      type="DB_VENDOR"：VendorDatabaseIdProvider， 作用是得到数据库厂商的标识，mybatis就能根据数据库厂商标识来执行不同的sql</span></span><br><span class="line"><span class="comment">      MySQL,Oracle,SQL Server ....</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">databaseIdProvider</span> <span class="attr">type</span>=<span class="string">"DB_VENDOR"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"SQL Server"</span> <span class="attr">value</span>=<span class="string">"sqlserver"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"MySQL"</span> <span class="attr">value</span>=<span class="string">"mysql"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"Oracle"</span> <span class="attr">value</span>=<span class="string">"oracle"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">databaseIdProvider</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2.UserMapper.xml中要对sqlserver数据库所查询的user修改为  [user]，加上中括号。这里的<strong>dataBaseId</strong>就是你对不同厂商数据库软件起的别名</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryUserById"</span> <span class="attr">resultType</span>=<span class="string">"com.ecjtu.User.User"</span> <span class="attr">databaseId</span>=<span class="string">"mysql"</span> &gt;</span></span><br><span class="line">    select * from user where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryUserById"</span> <span class="attr">resultType</span>=<span class="string">"com.ecjtu.User.User"</span> <span class="attr">databaseId</span>=<span class="string">"sqlserver"</span> &gt;</span></span><br><span class="line">    select * from [user] where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>若运行出现  错误：通过端口 1433 连接到主机 localhost 的 TCP/IP 连接失败。错误:“Connection refused: connect。解决：修改端口号和重启SQLServer服务即可 <a href="https://blog.csdn.net/u013282737/article/details/81013753" target="_blank" rel="noopener">https://blog.csdn.net/u013282737/article/details/81013753</a> </p>
<h2 id="8-mappers映射器"><a href="#8-mappers映射器" class="headerlink" title="8.mappers映射器"></a>8.mappers映射器</h2><p>将sql映射文件注册到全局配置（mybatis.xml）中，</p>
<p><strong>mapper</strong>:注册一个sql映射，<mapper>标签中有url,resource,class三个属性。<br>            注册配置文件：<br>                <strong>resource</strong>:使用相对于类路径的资源引用,应用类路径下的sql映射文件<br>                <strong>url</strong>:使用完全限定资源定位符,应用网络或磁盘路径下的sql映射文件<br>            注册接口：<br>                <strong>class</strong>:应用接口<br>                      1.有sql映射文件，映射文件名必须与接口同名，并且放在同一个目录（包）下；</mapper></p>
<p><img src="/2020/02/11/Mybatis2/1581685825405.png" alt="1581685825405"></p>
<p>​                      2.没有SQL映射文件，所有的Dao接口都是利用注解写在接口上。这里注意，<strong>如果接了注解，sql映射文件中（xxxmapper.xml）就不能有该条sql语句</strong>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"select * from user where id=#&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function">User <span class="title">queryUserById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line"><span class="comment">//    User queryUserById2(int id);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​                      推荐：<br>​                            比较复杂的Dao接口，写sql映射文件（mapper.xml）；<br>​                            不重要的，简单的Dao接口为了开发快速可以使用注解</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;mapper url="file:///var/mappers/AuthorMapper.xml"/&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;mapper class="com.ecjtu.mapper.UserMapper"/&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;mapper resource="com/ecjtu/mapper/UserMapper.xml" /&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.ecjtu.mapper"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="四-映射文件"><a href="#四-映射文件" class="headerlink" title="四.映射文件"></a>四.映射文件</h1><p>映射文件指导着Mybatis如何进行数据库增删改查，有着非常重要的意义</p>
<h2 id="1-测试增删改查"><a href="#1-测试增删改查" class="headerlink" title="1.测试增删改查"></a>1.测试增删改查</h2><p>首先是写增删改查接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">    <span class="function">User <span class="title">queryUserById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deleteUserById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">updateUser</span><span class="params">(User user)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insertUser</span><span class="params">(User user)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>sql映射文件编写</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--values 中的值与User对象中的属性值相同--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"insertUser"</span>&gt;</span></span><br><span class="line">        insert into user(name,gender,email) values(#&#123;name&#125;,#&#123;gender&#125;,#&#123;email&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--name=#&#123;name&#125;  前面的name是表列名，#&#123;name&#125;中的name是对象属性name--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateUser"</span> <span class="attr">parameterType</span>=<span class="string">"User"</span>&gt;</span></span><br><span class="line">        update user</span><br><span class="line">         set</span><br><span class="line">          name=#&#123;name&#125;,gender=#&#123;gender&#125;,email=#&#123;email&#125;</span><br><span class="line">        where id=#&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteUserById"</span> &gt;</span></span><br><span class="line">        delete from user where id=#&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryUserById"</span>  <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"com.ecjtu.user.User"</span> &gt;</span></span><br><span class="line">        select * from user where id=#&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>最后测试，编写增删改查代码</p>
<p><strong>注意</strong>：User类中要有无参构造器和有参构造器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">	<span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        InputStream inputStream=Resources.getResourceAsStream(<span class="string">"mybatis.xml"</span>);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory=<span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        <span class="comment">//1.这里的openSession选择不是auto自动提交,</span></span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">        UserMapper mapper = session.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        <span class="comment">//id填null会报错，因为在User有参构造中有id属性，且id在数据库已中设置为自增，所以这里可以随便填。</span></span><br><span class="line">        User user1 = <span class="keyword">new</span> User(<span class="number">1</span>,<span class="string">"insert"</span>,<span class="string">"1"</span>,<span class="string">"www.insert.com"</span>);</span><br><span class="line">       </span><br><span class="line"><span class="comment">//  增  mapper.insertUser(user1);</span></span><br><span class="line"><span class="comment">//  改  mapper.updateUser(user1);</span></span><br><span class="line"><span class="comment">//  删  mapper.deleteUserById(2);</span></span><br><span class="line"><span class="comment">//        2.手动提交数据</span></span><br><span class="line">        session.commit();</span><br><span class="line"><span class="comment">//        User user = mapper.queryUserById(1);</span></span><br><span class="line"><span class="comment">//        System.out.println(user1);</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>另外，mybatis也允许增删改直接定义为 int , Long ,Boolean返回类型；</p>
<p>手动提交也可以变为自动提交;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SqlSession session = sqlSessionFactory.openSession(<span class="keyword">true</span>);</span><br></pre></td></tr></table></figure>



<p>例如：定义为boolean返回类型。先在接口中将抽象方法定义为boolean，才可以在测试方法中定义boolean返回值</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">updateUser</span><span class="params">(User user)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">boolean</span> b = mapper.updateUser(user1);</span><br><span class="line">System.out.println(b);</span><br></pre></td></tr></table></figure>

<h2 id="2-insert获取自增主键的值（粗略）"><a href="#2-insert获取自增主键的值（粗略）" class="headerlink" title="2.insert获取自增主键的值（粗略）"></a>2.insert获取自增主键的值（粗略）</h2><p>mysql支持自增主键，自增主键值的获取<br>        mybatis可以利用statement.getGeneratedKeys();<br>        useGeneratedKeys=”true”,使用自增主键获取主键值;<br>        KeyProperty:指定对应的主键书属性，也是mybatis获取主键值以后，将这个值封装给javaBean的那个属性;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"insertUser"</span> <span class="attr">useGeneratedKeys</span>=<span class="string">"true"</span> <span class="attr">keyProperty</span>=<span class="string">"id(javaBean中的属性)"</span>&gt;</span></span><br><span class="line">        insert into user(name,gender,email) values(#&#123;name&#125;,#&#123;gender&#125;,#&#123;email&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="3-参数处理"><a href="#3-参数处理" class="headerlink" title="3.参数处理"></a>3.参数处理</h2><h3 id="1-单个参数："><a href="#1-单个参数：" class="headerlink" title="1.单个参数："></a><strong>1.单个参数</strong>：</h3><p>mybatis不会特殊处理，#{参数名}，取出参数值</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryUserById"</span>  <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"com.ecjtu.user.User"</span> &gt;</span></span><br><span class="line">        select * from user where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-多个参数："><a href="#2-多个参数：" class="headerlink" title="2.多个参数："></a><strong>2.多个参数</strong>：</h3><p>mybatis会做特殊处理。多个参数会被封装成一个map，其中为键值对，我们写传入的参数，写的是键。</p>
<p>​                    Key：param1。。。paramN</p>
<p>​                    value：传入的参数值</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//接口</span></span><br><span class="line"><span class="function">User <span class="title">queryUserByIdAndName</span><span class="params">(<span class="keyword">int</span> id, String name)</span></span>;</span><br></pre></td></tr></table></figure>

<p>SQL语句编写，</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryUserByIdAndName"</span> <span class="attr">parameterType</span>=<span class="string">"User"</span> <span class="attr">resultType</span>=<span class="string">"com.ecjtu.user.User"</span>&gt;</span></span><br><span class="line">	第一个传入的参数的序号为0,第二个为1，以此类推到N-1</span><br><span class="line">        select * from user where id=#&#123;0&#125; and name=#&#123;1&#125;</span><br><span class="line">    或者写成param1。。。paramN，第一个传入的参数为param1，第二个传入的参数为param2，。。。paramN</span><br><span class="line">    	select * from user where id=#&#123;param1&#125; and name=#&#123;param2&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>多参数查询</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User user = mapper.queryUserByIdAndName(<span class="number">2</span>,<span class="string">"mysql"</span>);</span><br></pre></td></tr></table></figure>

<h3 id="3-命名参数"><a href="#3-命名参数" class="headerlink" title="3.命名参数"></a><strong>3.命名参数</strong></h3><p>由于用paramN这种写参数不见名知意，所以可以明确指定封装参数时map的Key</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">User <span class="title">queryUserByIdAndName</span><span class="params">(@Param(<span class="string">"666"</span>)</span> <span class="keyword">int</span> id,@<span class="title">Param</span><span class="params">(<span class="string">"name"</span>)</span> String name)</span>;</span><br></pre></td></tr></table></figure>

<p>这样处理后，sql语句中就可以写Param中指定的值</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryUserByIdAndName"</span> <span class="attr">parameterType</span>=<span class="string">"User"</span> <span class="attr">resultType</span>=<span class="string">"com.ecjtu.user.User"</span>&gt;</span></span><br><span class="line">        select * from user where id=#&#123;666&#125; and name=#&#123;name&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-POJO-amp-Map-amp-TO"><a href="#4-POJO-amp-Map-amp-TO" class="headerlink" title="4.POJO&amp;Map&amp;TO"></a>4.POJO&amp;Map&amp;TO</h3><p><strong>POJO:</strong></p>
<p>如果多个参数正好是我们业务逻辑的数据模型，我们就可以直接传入POJO</p>
<p>#{属性名}：取出传入POJO的属性值</p>
<p><strong>Map：</strong></p>
<p>如果多个参数不是业务模型中的数据，没有对应的POJO，不经常使用，为了方便我们也可以传入map</p>
<p>#{Key}:取出map中对应的值</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//接口中的方法</span></span><br><span class="line"><span class="function">User <span class="title">queryUserByMap</span><span class="params">(Map&lt;String,Object&gt; map)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;String,Object&gt; map=<span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">      map.put(<span class="string">"id"</span>,<span class="number">1</span>);</span><br><span class="line">      map.put(<span class="string">"name"</span>,<span class="string">"mysql"</span>);</span><br><span class="line">      User user = mapper.queryUserByMap(map);</span><br></pre></td></tr></table></figure>

<p>SQL语句中可以直接使用map中的Key</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryUserByMap"</span> <span class="attr">resultType</span>=<span class="string">"com.ecjtu.user.User"</span>&gt;</span></span><br><span class="line">        select * from user where id=#&#123;id&#125; and name=#&#123;name&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="5-参数处理拓展"><a href="#5-参数处理拓展" class="headerlink" title="5.参数处理拓展"></a>5.参数处理拓展</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">User <span class="title">getUser</span><span class="params">(@Param(<span class="string">"id"</span>)</span><span class="keyword">int</span> id ,String name)</span>;</span><br><span class="line">    取值：id-&gt; #&#123;id/Param1&#125;  ,name-&gt; #&#123;Param2&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">User <span class="title">getUser</span><span class="params">(<span class="keyword">int</span> id ,@Param(<span class="string">"us"</span>)</span>User user)</span>;</span><br><span class="line">    取值：id-&gt; #&#123;Param1&#125;  ,name-&gt; #&#123;Param2.name/us.name&#125;</span><br></pre></td></tr></table></figure>

<p><strong>特别注意</strong>，如果是Collection（List，Set）类型或者是数组，也会特殊处理，也是把传入的list或数组封装在map中。Key：collection     ,如果是List还可以使用Key：list，数组 array</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">User <span class="title">getUserById</span><span class="params">(List&lt;Integer&gt; ids)</span></span>;</span><br><span class="line">取值，取出第一个id的值： #&#123;list[0]&#125;</span><br></pre></td></tr></table></figure>



<h3 id="6-与-取值区别"><a href="#6-与-取值区别" class="headerlink" title="6.$与#取值区别"></a>6.$与#取值区别</h3><p><strong>#</strong>{}：是以预编译的形式，将参数设置到SQL语句中，防止SQL注入</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user where id=#&#123;id&#125; and name=#&#123;name&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2020/02/11/Mybatis2/C:%5CUsers%5Czhixia%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1582290567085.png" alt="1582290567085"></p>
<p><strong>$</strong>{}:取出的值直接拼在是SQL语句中，会有安全问题；</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user where id=$&#123;id&#125; and name=#&#123;name&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2020/02/11/Mybatis2/C:%5CUsers%5Czhixia%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1582290777294.png" alt="1582290777294"></p>
<p>大多数情况下我们使用 <strong>#{}</strong>取参数</p>
<p>但是原生的jdbc不支持占位符（？）的地方我们就可以使用<strong>${}</strong>进行取值</p>
<p>比如分表查询、排序</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from $&#123;year&#125;_salary where xxxx</span><br><span class="line">select * from user order by $&#123;name&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-更丰富的用法"><a href="#7-更丰富的用法" class="headerlink" title="7.#{}更丰富的用法"></a>7.#{}更丰富的用法</h3><p>规定参数的一些规则：javaType,jdbcType,mode(存储过程)，resultMap，typeHander,jdbcTypeName。</p>
<p><strong>jdbcType</strong>需要在某种特定情况下被设置。</p>
<p>在数据为null时，有些数据库不能识别mybatis对null的默认处理。比如oracle</p>
<p>由于全局配置中：jdbcTypeForNull=OTHER,oracle不支持，所以<strong>#{}</strong>取值可以有两种方法</p>
<p>1.#{name,jdbcType=NULL};</p>
<p>2.在mybatis.xml全集配置中设置jdbcTypeForNULL的值，#{就可以不用写     name,jdbcType=NULL}</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"jdbcTypeForNull"</span> <span class="attr">value</span>=<span class="string">"NULL"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="4-select"><a href="#4-select" class="headerlink" title="4.select"></a>4.select</h2><h3 id="1-返回值类型List"><a href="#1-返回值类型List" class="headerlink" title="1.返回值类型List"></a>1.返回值类型List</h3><p>返回值的类型是List，但是在SQL映射文件中的resultType还是集合中元素的类型，</p>
<p>这里是User</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">getUserBynameLike</span><span class="params">(String name)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserBynameLike"</span> <span class="attr">resultType</span>=<span class="string">"com.ecjtu.user.User"</span>&gt;</span></span><br><span class="line">    select * from user where name like #&#123;name&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-记录封装Map"><a href="#2-记录封装Map" class="headerlink" title="2.记录封装Map"></a>2.记录封装Map</h3><p>1.返回一条记录的map，Key就是列名，值就是对应的值</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Map&lt;String,User&gt; <span class="title">getUserReturnMap</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br></pre></td></tr></table></figure>

<p>返回值类型为map</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserReturnMap"</span> <span class="attr">resultType</span>=<span class="string">"java.util.Map"</span>&gt;</span></span><br><span class="line">    select * from user where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2.多条记录封装一个map，键是这条记录的主键，值就是记录封装后的javabean</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">@MapKey</span>(<span class="string">"name"</span>)<span class="comment">//告诉mybatis封装这个map的时候用哪个属性作为map的key</span></span><br><span class="line"><span class="comment">//    @MapKey("id"),这里指定的MapKey不一样查出的</span></span><br><span class="line">    <span class="function">Map&lt;String,User&gt; <span class="title">getUserByNameLikeReturnMap</span><span class="params">(String name)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserByNameLikeReturnMap"</span> <span class="attr">resultType</span>=<span class="string">"java.util.Map"</span>&gt;</span></span><br><span class="line">    select * from user where name like #&#123;name&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>以name为Key    查询结果：其中name  为insert 和mysql</p>
<p><img src="/2020/02/11/Mybatis2/1582297068104.png" alt="1582297068104"></p>
<p>以id 为Key     查询结果：1,2就是Key</p>
<p><img src="/2020/02/11/Mybatis2/1582297135413.png" alt="1582297135413"></p>
<p>这里的 @MapKey(“id”)修改后，Map&lt;String,User&gt;要改为Map&lt;Integer,User&gt;。就是以id作为key.</p>
<h3 id="3-resultMap"><a href="#3-resultMap" class="headerlink" title="3.resultMap"></a>3.resultMap</h3><p>自定义结果映射规则，在SQL语句外</p>
<!--这里的type写Javabean的相对路径-->
<pre><code>&lt;resultMap id=&quot;666&quot; type=&quot;com.ecjtu.user.User&quot;&gt;
    &lt;!--
    指定主键列的封装规则
    column：指定哪一列
    property：指定对应的javabean属性
    --&gt;
    &lt;id column=&quot;id&quot; property=&quot;id&quot;&gt;&lt;/id&gt;
    &lt;!--column对应数据库的列名，property为javabean中的属性--&gt;
    &lt;!-- 其他不指定的列会自动封装
    result标签中，如果数据库列名和Javabean属性名一致也可以不写，如果不一致就要写--&gt;
    &lt;result column=&quot;name&quot; property=&quot;name&quot;/&gt;</code></pre><p>​    </p>
<p>这样自定义之后，查询语句中应选择resultMap，且值为resultMap id=”666”</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryUserById"</span> <span class="attr">resultMap</span>=<span class="string">"666"</span> &gt;</span></span><br><span class="line">        select * from user where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-关联查询-级联属性封装结果"><a href="#4-关联查询-级联属性封装结果" class="headerlink" title="4.关联查询_级联属性封装结果"></a>4.关联查询_级联属性封装结果</h3><p>查两张表</p>
<p>查出use2 表中id=1的员工同时，查出另一张表department表中  use2.id=1的员工所在部门</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"MyDiffUser"</span> <span class="attr">type</span>=<span class="string">"com.ecjtu.user.User"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"name"</span> <span class="attr">property</span>=<span class="string">"name"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"gender"</span> <span class="attr">property</span>=<span class="string">"gender"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"did"</span> <span class="attr">property</span>=<span class="string">"dept.id"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"dept"</span> <span class="attr">property</span>=<span class="string">"dept.dept"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserAndDept"</span> <span class="attr">resultMap</span>=<span class="string">"MyDiffUser"</span>&gt;</span></span><br><span class="line">        SELECT</span><br><span class="line">        user2.id id,</span><br><span class="line">        user2.NAME NAME,</span><br><span class="line">        user2.gender gender,</span><br><span class="line">        user2.email email,</span><br><span class="line">        department.id did,</span><br><span class="line">        department.dept dept</span><br><span class="line">    FROM</span><br><span class="line">        department,</span><br><span class="line">        user2</span><br><span class="line">    WHERE</span><br><span class="line">        department.id = user2.d_id</span><br><span class="line">        AND user2.id =#&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>其中 User中有</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">private String name;</span><br><span class="line">private String gender;</span><br><span class="line">private String email;</span><br><span class="line">private Dept dept;</span><br></pre></td></tr></table></figure>

<p>四个属性，Dept为另外一个对象，包含  String id,String dept 两个属性；</p>
<h3 id="5-关联查询-association定义关联对象封装规则"><a href="#5-关联查询-association定义关联对象封装规则" class="headerlink" title="5.关联查询 association定义关联对象封装规则"></a>5.关联查询 association定义关联对象封装规则</h3><p>association可以指定联合的Javabean对象，使用association定义单个对象的封装规则</p>
<img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593412601501.png" alt="1593412601501" style="zoom:80%;">

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"MyDiffUser"</span> <span class="attr">type</span>=<span class="string">"com.ecjtu.user.User"</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"name"</span> <span class="attr">property</span>=<span class="string">"name"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"gender"</span> <span class="attr">property</span>=<span class="string">"gender"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">       </span><br><span class="line">       dept.id ,dept.dept,这是dept对象中的两个属性</span><br><span class="line">       <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"did"</span> <span class="attr">property</span>=<span class="string">"dept.id"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"dept"</span> <span class="attr">property</span>=<span class="string">"dept.dept"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">       </span><br><span class="line">       <span class="comment">&lt;!--property="dept" 指定哪个属性是联合的对象</span></span><br><span class="line"><span class="comment">           Javatype=“com.ecjtu.user.Dept” 指定这个属性对象的类型</span></span><br><span class="line"><span class="comment">       --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"dept"</span> <span class="attr">javaType</span>=<span class="string">"com.ecjtu.user.Dept"</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"did"</span> <span class="attr">property</span>=<span class="string">"id"</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"dept"</span> <span class="attr">property</span>=<span class="string">"dept"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">           后面俩property 都是Javabean中的属性</span><br><span class="line">       <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserAndDept"</span> <span class="attr">resultMap</span>=<span class="string">"MyDiffUser"</span>&gt;</span></span><br><span class="line">       SELECT</span><br><span class="line">       user2.id id,</span><br><span class="line">       user2.NAME NAME,</span><br><span class="line">       user2.gender gender,</span><br><span class="line">       user2.email email,</span><br><span class="line">       department.id did,</span><br><span class="line">       department.dept dept</span><br><span class="line">   FROM</span><br><span class="line">       department,</span><br><span class="line">       user2</span><br><span class="line">   WHERE</span><br><span class="line">       department.id = user2.id</span><br><span class="line">       AND user2.id =#&#123;id&#125;</span><br><span class="line">   <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="6-association分步查询"><a href="#6-association分步查询" class="headerlink" title="6.association分步查询"></a>6.association分步查询</h3><p>1.DynamicSQL.xml中执行分布查询</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!--使用association进行分步查询</span></span><br><span class="line"><span class="comment">        1.按照员工id查询员工信息</span></span><br><span class="line"><span class="comment">        2.根据员工信息中的d_id（员工表中有d_id这列） 去部门表查出部门信息</span></span><br><span class="line"><span class="comment">        3.查出的部门设置到员工中</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"MyUserByStep"</span> <span class="attr">type</span>=<span class="string">"com.ecjtu.user.User"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"name"</span> <span class="attr">property</span>=<span class="string">"name"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"gender"</span> <span class="attr">property</span>=<span class="string">"gender"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"email"</span> <span class="attr">property</span>=<span class="string">"email"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--association 定义单个关联对象的封装规则</span></span><br><span class="line"><span class="comment">        select:表明当前属性dept是调用select指定的方法查出的结果</span></span><br><span class="line"><span class="comment">        column:指定将哪一列的值传给这个方法</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"dept"</span> <span class="attr">user</span>对象中<span class="attr">dept</span>属性</span></span><br><span class="line"><span class="tag">                 <span class="attr">select</span>=<span class="string">"com.ecjtu.mapper.DepartmentMapper.getDeptById"</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">column</span>=<span class="string">"d_id"</span> &gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- 根据user表中查出的d_id 给DepartmentMapper.getDeptById方法查出dept --&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--User getUserByIdStep(String id);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserByIdStep"</span> <span class="attr">resultMap</span>=<span class="string">"MyUserByStep"</span>&gt;</span></span><br><span class="line">    select * from user2 where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2.在DepartmentMapper.xml有根据部门id查部门方法</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.ecjtu.mapper.DepartmentMapper"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--Dept getDeptById(String id);--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getDeptById"</span> <span class="attr">resultType</span>=<span class="string">"com.ecjtu.user.Dept"</span>&gt;</span></span><br><span class="line">        select * from department where id=#&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>3.测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDynamicSQL</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    InputStream inputStream =Resources.getResourceAsStream(<span class="string">"mybatis.xml"</span>);</span><br><span class="line">    SqlSessionFactory sqlSessionFactory= <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">    SqlSession openSession = sqlSessionFactory.openSession();</span><br><span class="line">    DynamicSQL mapper = openSession.getMapper(DynamicSQL<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    User userByIdStep = mapper.getUserByIdStep(<span class="string">"4"</span>);</span><br><span class="line">    System.out.println(userByIdStep);</span><br><span class="line">    System.out.println(userByIdStep.getDept());</span><br></pre></td></tr></table></figure>

<p>4.查询结果</p>
<img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593415666820.png" alt="1593415666820" style="zoom:80%;">

<h3 id="7-延迟加载"><a href="#7-延迟加载" class="headerlink" title="7.延迟加载"></a>7.延迟加载</h3><p>在 mybatis.xml  中（mybatis核心配置文件），加入</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"lazyLoadingEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">setting</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"aggressiveLazyLoading"</span> <span class="attr">value</span>=<span class="string">"false"</span>&gt;</span><span class="tag">&lt;/<span class="name">setting</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>当</p>
<p><strong>System.out.println(userByIdStep.getGender());</strong> </p>
<p>只需要第一sql语句中的某一个属性时（与部门信息无关），只会加载第一条sql语句，不会两条都加载，若需要部门属性，则两条sql语句都会加载。</p>
<p>即为 按需查询</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User userByIdStep = mapper.getUserByIdStep(<span class="string">"4"</span>);</span><br><span class="line">System.out.println(userByIdStep.getEmail());</span><br></pre></td></tr></table></figure>



<img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593594856661.png" alt="1593594856661" style="zoom:80%;">

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">当查询部门时，就会加载两条SQL语句</span><br><span class="line">User userByIdStep=mapper.getUserByIdStep(<span class="string">"4"</span>);</span><br><span class="line">System.out.println(userByIdStep.getDept());</span><br></pre></td></tr></table></figure>

<img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593594651522.png" alt="1593594651522" style="zoom:80%;">









<h3 id="8-collection定义关联集合封装规则"><a href="#8-collection定义关联集合封装规则" class="headerlink" title="8.collection定义关联集合封装规则"></a>8.collection定义关联集合封装规则</h3><p>场景：查询部门的时候将部门对应的所有员工信息也查询出来</p>
<p>collection嵌套结果集的方式，定义关联的集合类型元素的封装规则。</p>
<p>表中数据：</p>
<img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593605779361.png" alt="1593605779361" style="zoom:80%;">

<img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593605767592.png" alt="1593605767592" style="zoom:80%;">

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--d.id did,--&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--d.dept,--&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--u.id uid,--&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--u.NAME uname,--&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--u.gender,--&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--u.email--&gt;</span></span><br><span class="line"></span><br><span class="line">dept对象中的三个属性</span><br><span class="line">   <span class="comment">&lt;!--String id;--&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--String dept;--&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--List&lt;User&gt; users;--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"MyDept"</span> <span class="attr">type</span>=<span class="string">"com.ecjtu.user.Dept"</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"did"</span> <span class="attr">property</span>=<span class="string">"id"</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"dept"</span> <span class="attr">property</span>=<span class="string">"dept"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">           collection 定义关联集合类型的属性的封装规则</span></span><br><span class="line"><span class="comment">           ofType：指定集合中元素的类型</span></span><br><span class="line"><span class="comment">       --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"users"</span> <span class="attr">ofType</span>=<span class="string">"com.ecjtu.user.User"</span>&gt;</span></span><br><span class="line">           <span class="comment">&lt;!--定义这个元素的封装规则--&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"uid"</span> <span class="attr">property</span>=<span class="string">"id"</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"uname"</span> <span class="attr">property</span>=<span class="string">"name"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"gender"</span> <span class="attr">property</span>=<span class="string">"gender"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"email"</span> <span class="attr">property</span>=<span class="string">"email"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--Dept getDeptByIdPlus(String id);--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getDeptByIdPlus"</span> <span class="attr">resultMap</span>=<span class="string">"MyDept"</span>&gt;</span></span><br><span class="line">       SELECT</span><br><span class="line">           d.id did,</span><br><span class="line">           d.dept,</span><br><span class="line">           u.id uid,</span><br><span class="line">           u.NAME uname,</span><br><span class="line">           u.gender,</span><br><span class="line">           u.email</span><br><span class="line">       FROM</span><br><span class="line">           department d</span><br><span class="line">       LEFT JOIN user2 u ON d.id = u.d_id</span><br><span class="line">       WHERE</span><br><span class="line">           d.id =#&#123;id&#125;</span><br><span class="line">   <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>测试</p>
<p><img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593605813798.png" alt="1593605813798"></p>
<h3 id="9-collection分步查询"><a href="#9-collection分步查询" class="headerlink" title="9.collection分步查询"></a>9.collection分步查询</h3><p>嵌套结果集的方式，使用collection标签定义关联的集合类型的属性封装规则</p>
<p>在DynamicSQL.xml中有只有根据部门id 查出所有属于该部门的user</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUsersByDeptId"</span> <span class="attr">resultType</span>=<span class="string">"com.ecjtu.user.User"</span>&gt;</span></span><br><span class="line">    select * from user2 where d_id =#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在DepartmentMapper.xml中,分步查询</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"MyDeptStep"</span> <span class="attr">type</span>=<span class="string">"com.ecjtu.user.Dept"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"dept"</span> <span class="attr">property</span>=<span class="string">"dept"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"users"</span> <span class="attr">select</span>=<span class="string">"com.ecjtu.mapper.DynamicSQL.getUsersByDeptId"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span><span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--column  就是把那一列的值传给这个方法--&gt;</span></span><br><span class="line">    先执行getDeptByIdStep，根据部门id查出部门，再根据部门id查出此部门下的所有user用户</span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Dept getDeptByIdStep(String id);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getDeptByIdStep"</span> <span class="attr">resultMap</span>=<span class="string">"MyDeptStep"</span>&gt;</span></span><br><span class="line">    select id ,dept from department where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Dept deptByIdStep = mapper.getDeptByIdStep(<span class="string">"1"</span>);</span><br><span class="line">System.out.println(deptByIdStep);</span><br><span class="line">System.out.println(deptByIdStep.getUsers());</span><br></pre></td></tr></table></figure>

<p><img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593608766117.png" alt="1593608766117"></p>
<h3 id="10-将多列的值传递和fetchType"><a href="#10-将多列的值传递和fetchType" class="headerlink" title="10.将多列的值传递和fetchType"></a>10.将多列的值传递和fetchType</h3><p>将多列的值封装map传递</p>
<p>column=“｛key1=column1,key2=column2｝”</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"MyDeptStep"</span> <span class="attr">type</span>=<span class="string">"com.ecjtu.user.Dept"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"dept"</span> <span class="attr">property</span>=<span class="string">"dept"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"users"</span> <span class="attr">select</span>=<span class="string">"com.ecjtu.mapper.DynamicSQL.getUsersByDeptId"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">column</span>=<span class="string">"&#123;dept=id&#125;"</span> <span class="attr">fetchType</span>=<span class="string">"eager或者lazy"</span>&gt;</span><span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--column  就是把那一列的值传给这个方法--&gt;</span></span><br><span class="line">    先执行getDeptByIdStep，根据部门id查出部门，再根据部门id查出此部门下的所有user用户</span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Dept getDeptByIdStep(String id);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getDeptByIdStep"</span> <span class="attr">resultMap</span>=<span class="string">"MyDeptStep"</span>&gt;</span></span><br><span class="line">    select id ,dept from department where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>fetchType : fetchType=”eager或者lazy”  表示立即加载或延迟加载</p>
<h3 id="11-discriminator鉴别器"><a href="#11-discriminator鉴别器" class="headerlink" title="11.discriminator鉴别器"></a>11.discriminator鉴别器</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserByIdStep"</span> <span class="attr">resultMap</span>=<span class="string">"MyUserDis"</span>&gt;</span></span><br><span class="line">         select * from user2 where id=#&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;discriminator javaType=""&gt;</span></span><br><span class="line"><span class="comment">       &lt;case value=""&gt;&lt;/case&gt;</span></span><br><span class="line"><span class="comment">&lt;/discriminator&gt;</span></span><br><span class="line"><span class="comment">鉴别器：mybatis可以使用discrimination判断某列的值，然后根据某列的值改变封装行为</span></span><br><span class="line"><span class="comment">封装user：</span></span><br><span class="line"><span class="comment">    如果查出的是女生，就把部门信息查询出来，否则不查询</span></span><br><span class="line"><span class="comment">    如果是男生，就把name这列的值赋值给email</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"MyUserDis"</span> <span class="attr">type</span>=<span class="string">"com.ecjtu.user.User"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"name"</span> <span class="attr">property</span>=<span class="string">"name"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"gender"</span> <span class="attr">property</span>=<span class="string">"gender"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"email"</span> <span class="attr">property</span>=<span class="string">"email"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--column="" 指定判定的列名</span></span><br><span class="line"><span class="comment">            javaType="" 列值对应的Java类型</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">discriminator</span> <span class="attr">javaType</span>=<span class="string">"String"</span> <span class="attr">column</span>=<span class="string">"gender"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--男</span></span><br><span class="line"><span class="comment">            resultType="com.ecjtu.user.User"  指定封装的结果类型</span></span><br><span class="line"><span class="comment">            --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">case</span> <span class="attr">value</span>=<span class="string">"1"</span> <span class="attr">resultType</span>=<span class="string">"com.ecjtu.user.User"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"name"</span> <span class="attr">property</span>=<span class="string">"name"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"gender"</span> <span class="attr">property</span>=<span class="string">"gender"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"name"</span> <span class="attr">property</span>=<span class="string">"email"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">case</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!--女--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">case</span> <span class="attr">value</span>=<span class="string">"0"</span> <span class="attr">resultType</span>=<span class="string">"com.ecjtu.user.User"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"dept"</span></span></span><br><span class="line"><span class="tag">                             <span class="attr">select</span>=<span class="string">"com.ecjtu.mapper.DepartmentMapper.getDeptById"</span></span></span><br><span class="line"><span class="tag">                             <span class="attr">column</span>=<span class="string">"d_id"</span>    &gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">case</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">discriminator</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>测试 女生</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DynamicSQL mapper = openSession.getMapper(DynamicSQL<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        User userByIdStep = mapper.getUserByIdStep(<span class="string">"3"</span>);</span><br><span class="line"><span class="comment">//        System.out.println(userByIdStep.getEmail());</span></span><br><span class="line">        System.out.println(userByIdStep);</span><br></pre></td></tr></table></figure>

<p><img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593680681385.png" alt="1593680681385"></p>
<p>测试男生</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User userByIdStep = mapper.getUserByIdStep(<span class="string">"1"</span>);</span><br></pre></td></tr></table></figure>

<img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593680733679.png" alt="1593680733679" style="zoom:80%;">



<h2 id="5-动态SQL"><a href="#5-动态SQL" class="headerlink" title="5.动态SQL"></a>5.动态SQL</h2><h3 id="1-where标签"><a href="#1-where标签" class="headerlink" title="1.where标签"></a>1.where标签</h3><p>封装查询条件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    if</span></span><br><span class="line"><span class="comment">    choose(when,otherwise)</span></span><br><span class="line"><span class="comment">    trim(where,set)</span></span><br><span class="line"><span class="comment">    foreach</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"></span><br><span class="line">    if <span class="comment">&lt;!--查询员工，要求：携带了哪个字段查询条件 就带上这个字段的值--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        List&lt;User&gt; getUserByConditionIf(User user);</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--id 为接口里的方法名--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserByConditionIf"</span> <span class="attr">resultType</span>=<span class="string">"com.ecjtu.user.User"</span>&gt;</span></span><br><span class="line">        select  * from user2</span><br><span class="line">        where</span><br><span class="line">        <span class="comment">&lt;!--  test:判断表达式（OGNL）</span></span><br><span class="line"><span class="comment">        从参数中取值进行判断  传过来的id!=null的情况下（ #&#123;这里面的id&#125; )，才进行拼接</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"id!=null"</span>&gt;</span></span><br><span class="line">            id=#&#123;id&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        &amp;amp; 为 &amp; 符号，&amp;quot;为双引号 " "</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"name!=null and name!=''"</span>&gt;</span></span><br><span class="line">            and name like #&#123;name&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"email!=null and email.trim()!=''"</span>&gt;</span></span><br><span class="line">            and email=#&#123;email&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!----&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"gender==0 or gender==1"</span>&gt;</span></span><br><span class="line">            and gender=#&#123;gender&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDynamicSQL</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        InputStream inputStream =Resources.getResourceAsStream(<span class="string">"mybatis.xml"</span>);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory= <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession openSession = sqlSessionFactory.openSession();</span><br><span class="line">        DynamicSQL mapper = openSession.getMapper(DynamicSQL<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        User user = <span class="keyword">new</span> User(<span class="number">4</span>,<span class="keyword">null</span>,<span class="keyword">null</span>,<span class="string">"444.com"</span>);</span><br><span class="line">        List&lt;User&gt; userByConditionIf = mapper.getUserByConditionIf(user);</span><br><span class="line">        <span class="keyword">for</span> (User user1:userByConditionIf) &#123;</span><br><span class="line">            System.out.println(user1);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>由于传过去的名字为null，所以动态SQL查询语句中没有  name=xxx</p>
<p><img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593350704119.png" alt="1593350704119"></p>
<p>如果某些条件没带 id=x，sql语句拼接可能会有问题，直接在where 后面接了 and  ，导致sql语句错误</p>
<p><img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593350987235.png" alt="1593350987235"></p>
<p>解决方案：</p>
<p>1.在动态SQL 的where后面直接加  1=1 ，if中的sql 都加and</p>
<img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593351162924.png" alt="1593351162924" style="zoom:80%;">

<p>2.mybatis使用where标签来将所有的查询条件包括在内，mybatis会将多出来的and 或者or去掉。是 and id=#{id} ,前面的and ，where标签可以处理，但是后面的and，where标签不能处理。所以用到trim标签</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserByConditionIf"</span> <span class="attr">resultType</span>=<span class="string">"com.ecjtu.user.User"</span>&gt;</span></span><br><span class="line">        select  * from user2</span><br><span class="line">        <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"id!=null"</span>&gt;</span></span><br><span class="line">                and id=#&#123;id&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">           </span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"name!=null and name!=''"</span>&gt;</span></span><br><span class="line">                and name like #&#123;name&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"email!=null and email.trim()!=''"</span>&gt;</span></span><br><span class="line">                and email=#&#123;email&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"gender==0 or gender==1"</span>&gt;</span></span><br><span class="line">                and gender=#&#123;gender&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-chose-标签-分支选择-：switch-case"><a href="#2-chose-标签-分支选择-：switch-case" class="headerlink" title="2.chose 标签 分支选择 ：switch-case"></a>2.chose 标签 分支选择 ：switch-case</h3><p>如果带了id就用id 查，如果带了name，就用name查，选择其中一个,否则otherwise 执行另外的语句</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User user = <span class="keyword">new</span> User(<span class="keyword">null</span>,<span class="keyword">null</span>,<span class="string">"1"</span>,<span class="keyword">null</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserByConditionChoose"</span> <span class="attr">resultType</span>=<span class="string">"com.ecjtu.user.User"</span> &gt;</span></span><br><span class="line">        select * from user2</span><br><span class="line">        <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">choose</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"id!=null"</span>&gt;</span></span><br><span class="line">                id=#&#123;id&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"name!=null"</span>&gt;</span></span><br><span class="line">                and name like #&#123;name&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"email!=null"</span>&gt;</span></span><br><span class="line">               and email = #&#123;email&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">otherwise</span>&gt;</span></span><br><span class="line">                gender=#&#123;gender&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">otherwise</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-set-更新"><a href="#3-set-更新" class="headerlink" title="3.set  更新"></a>3.set  更新</h3><p>会处理多了的 “  ， ”逗号</p>
<img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593355236184.png" alt="1593355236184" style="zoom:80%;">

<p>​    <img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593355267074.png" alt="1593355267074" style="zoom:80%;"></p>
<h3 id="4-foreach批量查询"><a href="#4-foreach批量查询" class="headerlink" title="4.foreach批量查询"></a>4.foreach批量查询</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span>  <span class="title">DynamicSQL</span> </span>&#123;</span><br><span class="line">    <span class="comment">//查用户id在给定集合中</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">getUserForeach</span><span class="params">(@Param(<span class="string">"ids"</span>)</span>List&lt;String&gt; asList)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserForeach"</span> <span class="attr">resultType</span>=<span class="string">"com.ecjtu.user.User"</span>&gt;</span></span><br><span class="line">          select * from user2</span><br><span class="line">        <span class="comment">&lt;!--collection：指定要遍历的集合</span></span><br><span class="line"><span class="comment">			list类型的参数会特殊处理封装在map中，map的key就叫list</span></span><br><span class="line"><span class="comment">   			item：将当前遍历出的元素赋值给指定的变量</span></span><br><span class="line"><span class="comment">			separator：每个元素之间的分隔符</span></span><br><span class="line"><span class="comment">			open：遍历出所有结果拼接一个开始的字符</span></span><br><span class="line"><span class="comment">			close：遍历出所有结果拼接一个结束的字符</span></span><br><span class="line"><span class="comment">			#&#123;变量名&#125; 取出变量的值 ，也就是当前遍历出的元素</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"ids"</span> <span class="attr">item</span>=<span class="string">"id"</span> <span class="attr">separator</span>=<span class="string">","</span> <span class="attr">open</span>=<span class="string">" where id in ("</span> <span class="attr">close</span>=<span class="string">")"</span>&gt;</span></span><br><span class="line">              #&#123;id&#125;</span><br><span class="line">          <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">DynamicSQL mapper = openSession.getMapper(DynamicSQL<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">List&lt;User&gt; list=mapper.getUserForeach(Arrays.asList(<span class="string">"1"</span>,<span class="string">"2"</span>));</span><br><span class="line"><span class="keyword">for</span> (User  user:list</span><br><span class="line">     ) &#123;</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593695116298.png" alt="1593695116298" style="zoom:80%;">

<h3 id="5-foreach批量插入"><a href="#5-foreach批量插入" class="headerlink" title="5.foreach批量插入"></a>5.foreach批量插入</h3><p>接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addUsers</span><span class="params">(@Param(<span class="string">"users"</span>)</span> List&lt;User&gt; users)</span>;</span><br></pre></td></tr></table></figure>

<p>mapper.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">&lt;!--===================foreach批量插入=============--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--void addUsers(@Param("users") List&lt;User&gt; users);--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--                方法一            --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addUsers"</span>&gt;</span></span><br><span class="line">        insert into user2 (name,gender,email,d_id) VALUES</span><br><span class="line">        <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"users"</span> <span class="attr">separator</span>=<span class="string">","</span> <span class="attr">item</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line">            (#&#123;user.name&#125;,#&#123;user.gender&#125;,#&#123;user.email&#125;,#&#123;user.dept.id&#125;)</span><br><span class="line">            <span class="comment">&lt;!--这里的user.dept.id   是因为在user对象中，还有一个dept对象，dept的id是dept.ip--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--   方法二  但是要配置MySQL数据库连接	在url后加 &amp;allowMultiQueries=true 这种分号分隔多个sql  也可用于批量修改，删除   --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addUsers"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"users"</span> <span class="attr">item</span>=<span class="string">"user"</span> <span class="attr">separator</span>=<span class="string">";"</span>&gt;</span></span><br><span class="line">            insert into user2 (name, gender, email, d_id) values (#&#123;user.name&#125;,#&#123;user.gender&#125;,#&#123;user.email&#125;,#&#123;user.dept.id&#125;)</span><br><span class="line">        <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593782780298.png" alt="1593782780298" style="zoom:80%;">

<p>测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">DynamicSQL mapper = openSession.getMapper(DynamicSQL<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">List&lt;User&gt; users = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">users.add(<span class="keyword">new</span> User(<span class="string">""</span>,<span class="string">"李子雄"</span>,<span class="string">"0"</span>,<span class="string">"lzx@qq.com"</span>,</span><br><span class="line">        <span class="keyword">new</span> Dept(<span class="string">"1"</span>)));</span><br><span class="line">users.add(<span class="keyword">new</span> User(<span class="string">""</span>,<span class="string">"洗了费"</span>,<span class="string">"1"</span>,<span class="string">"xlf@qq.com"</span>,</span><br><span class="line">        <span class="keyword">new</span> Dept(<span class="string">"2"</span>)));</span><br><span class="line">mapper.addUsers(users);</span><br><span class="line">openSession.commit();</span><br></pre></td></tr></table></figure>

<p>方法一发了一条sql语句</p>
<p><img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593782979585.png" alt="1593782979585"></p>
<p>方法二连续发了两条sql语句</p>
<p><img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1593783066611.png" alt="1593783066611"></p>
<h3 id="6-内置参数-parameter-amp-databaseId"><a href="#6-内置参数-parameter-amp-databaseId" class="headerlink" title="6.内置参数 _parameter &amp; _databaseId"></a>6.内置参数 _parameter &amp; _databaseId</h3><p>1._parameter :代表整个参数</p>
<p>​        单个参数:_parameter就是这个参数</p>
<p>​        多个参数：参数会被封装成一个Map，_parameter就是代表这个map</p>
<p>2._databaseId:数据库的别名</p>
<img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1594696496143.png" alt="1594696496143" style="zoom:80%;">

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--=======================内置参数==============================   --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--List&lt;User&gt; getUserTestInnerparameter(User user);--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserTestInnerparameter"</span> <span class="attr">resultType</span>=<span class="string">"com.ecjtu.user.User"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"_databaseId=='mysql'"</span>&gt;</span></span><br><span class="line">            select * from user2</span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"_parameter!=null"</span>&gt;</span></span><br><span class="line">                _parameter就是name，也可以是其他参数</span><br><span class="line">                where name=#&#123;name&#125; 或者 name=#&#123;_parameter.name&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">List&lt;User&gt; <span class="title">getUserTestInnerparameter</span><span class="params">(User user)</span></span>;</span><br></pre></td></tr></table></figure>

<p>测试:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">DynamicSQL mapper = openSession.getMapper(DynamicSQL<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">User user1 = <span class="keyword">new</span> User();</span><br><span class="line">user1.setName(<span class="string">"付聪"</span>);</span><br><span class="line">List&lt;User&gt; users = mapper.getUserTestInnerparameter(user1);</span><br><span class="line"><span class="keyword">for</span> (User user: users</span><br><span class="line">     ) &#123;</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1594697548587.png" alt="1594697548587" style="zoom:80%;">

<h3 id="7-bind绑定"><a href="#7-bind绑定" class="headerlink" title="7.bind绑定"></a>7.bind绑定</h3><p>bind ：可以将ognl表达式的值绑定到一个变量中，方便后来引用这个变量的值</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">&lt;!--List&lt;User&gt; getUserTestInnerparameter(User user);--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserTestInnerparameter"</span> <span class="attr">resultType</span>=<span class="string">"com.ecjtu.user.User"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--         bind ：可以将ognl表达式的值绑定到一个变量中，方便后来引用这个变量的值</span></span><br><span class="line"><span class="comment">			bind 标签中，name为绑定后参数的名称，value是绑定形式</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bind</span> <span class="attr">name</span>=<span class="string">"Name"</span> <span class="attr">value</span>=<span class="string">"'%'+name+'%'"</span>&gt;</span><span class="tag">&lt;/<span class="name">bind</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"_databaseId=='mysql'"</span>&gt;</span></span><br><span class="line">            select * from user2</span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"_parameter!=null"</span>&gt;</span></span><br><span class="line">                where name like #&#123;Name&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">DynamicSQL mapper = openSession.getMapper(DynamicSQL<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        User user1 = <span class="keyword">new</span> User();</span><br><span class="line">        user1.setName(<span class="string">"聪"</span>);</span><br><span class="line">        List&lt;User&gt; users = mapper.getUserTestInnerparameter(user1);</span><br><span class="line">        <span class="keyword">for</span> (User user: users</span><br><span class="line">             ) &#123;</span><br><span class="line">            System.out.println(user);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>测试，发现Parameter是%聪%，将%与传入的参数拼接了</p>
<img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1594719721573.png" alt="1594719721573" style="zoom:80%;">

<p>模糊查询：不过还是建议直接在参数中加%%</p>
<h3 id="8-sql-抽取可重用的sql片段"><a href="#8-sql-抽取可重用的sql片段" class="headerlink" title="8. sql 抽取可重用的sql片段"></a>8. sql 抽取可重用的sql片段</h3><p>抽取可重用的sql片段，方便以后使用</p>
<p>1.SQL抽取：经常要查询的列名，或者插入用的列名抽取出来方便引用</p>
<p>2.include来引用已经抽取的SQL；</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addUsers"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"users"</span> <span class="attr">item</span>=<span class="string">"user"</span> <span class="attr">separator</span>=<span class="string">";"</span>&gt;</span></span><br><span class="line">            insert into user2 (</span><br><span class="line">            <span class="comment">&lt;!--&lt;include&gt;引用外部定义的sql--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"insertColumn"</span>&gt;</span><span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            ) values (#&#123;user.name&#125;,#&#123;user.gender&#125;,#&#123;user.email&#125;,#&#123;user.dept.id&#125;)</span><br><span class="line">        <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">"insertColumn"</span>&gt;</span></span><br><span class="line">     name, gender, email, d_id</span><br><span class="line">    这里面也可以用if标签，如果是mysql数据库就用下面字段</span><br><span class="line">       <span class="comment">&lt;!--&lt;if test="_databaseId=='mysql'"&gt;--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--name, gender, email, d_id--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;/if&gt;--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="6-缓存机制"><a href="#6-缓存机制" class="headerlink" title="6.缓存机制"></a>6.缓存机制</h2><p>mybatis系统中默认定义了两级缓存：一级缓存和二级缓存</p>
<p>1.一级缓存（本地缓存）：默认情况下，只有一级缓存（Sqlsession级别的缓存，也称本地缓存）开启。</p>
<p>2.二级缓存（全局缓存）：需要手动开启和配置，它是基于namespace级别的缓存.</p>
<p>3.为了提高拓展性。MyBatis定义了缓存接口Cache，我们通过实现Cache接口来定义二级缓存</p>
<h3 id="1-一级缓存体验"><a href="#1-一级缓存体验" class="headerlink" title="1.一级缓存体验"></a>1.一级缓存体验</h3><p>与数据库同一次会话期间查询到的数据会放在本地缓存中。以后如果需要获取相同的数据，没必要再去查询数据库，直接从缓存中拿。 </p>
<p>测试：两次调用同一个方法，但是只发送了一个SQL，并且user跟user1是相等的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">UserMapper mapper = openSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">         User user = mapper.getUserById(<span class="string">"1"</span>);</span><br><span class="line">         System.out.println(user);</span><br><span class="line">         User user1 = mapper.getUserById(<span class="string">"1"</span>);</span><br><span class="line">         System.out.println(user1);</span><br><span class="line">         System.out.println(user==user1);</span><br></pre></td></tr></table></figure>

<img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1594730845256.png" alt="1594730845256" style="zoom:80%;">

<h3 id="2-一级缓存失效的四种情况"><a href="#2-一级缓存失效的四种情况" class="headerlink" title="2.一级缓存失效的四种情况"></a>2.一级缓存失效的四种情况</h3><p><strong>1.sqlsession不同</strong></p>
<p>两次不同的sqlsession，调用同一方法也不是同一个一级缓存。</p>
<p><img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1594731656505.png" alt="1594731656505"></p>
<img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1594731691831.png" alt="1594731691831" style="zoom:80%;">

<p><strong>2.sqlsession相同，查询条件不同</strong></p>
<p>当前一级缓存中还没有这个数据；</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">User user = mapper.getUserById(<span class="string">"1"</span>);</span><br><span class="line">System.out.println(user);</span><br><span class="line">User user1 = mapper.getUserById(<span class="string">"2"</span>);</span><br><span class="line">System.out.println(user1);</span><br><span class="line">System.out.println(user==user1);</span><br></pre></td></tr></table></figure>

<img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1594732420990.png" alt="1594732420990" style="zoom:80%;">

<p><strong>3.sqlsession相同，两次查询之间执行了增删改操作</strong></p>
<p>这次增删改可能对当前数据有影响。</p>
<p><strong>4.sqlsession相同，手动清除了一级缓存</strong></p>
<p>缓存清空。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openSession.clearCache();</span><br></pre></td></tr></table></figure>

<h3 id="3-二级缓存介绍"><a href="#3-二级缓存介绍" class="headerlink" title="3.二级缓存介绍"></a>3.二级缓存介绍</h3><p>二级缓存是全局缓存，基于namespace级别的缓存，一个namespace对应一个二级缓存；</p>
<p><strong>工作机制：</strong></p>
<p>1.一个会话，查询一条数据，这个数据就会放在当前会话的一级缓存中。</p>
<p>2.如果会话关闭，一级缓存中的数据会保存到二级缓存中；新的会话查询信息，就可以参照二级缓存中的内容；</p>
<p>3.不同的namespace查出的数据会放在自己对应的缓存中（map中）</p>
<p>效果：数据会从二级缓存中取出，查出的数据都会默认先放在一级缓存中。只有会话提交或关闭后，一级缓存中的数据才会转移到二级缓存。</p>
<p><strong>二级缓存使用：</strong></p>
<p>1.开启二级缓存配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--在settings标签中配置二级缓存--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"cacheEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>2.去mapper.xml中配置使用二级缓存</p>
<p><cache></cache></p>
<pre><code>eviction:缓存的回收策略：
    LRU：最近最少使用，移除长时间不被使用的对象。
    FIFO：先进先出，按对象进入缓存的顺序来移除它们。
    SOFT：软引用，移除基于垃圾回收器状态和软引用规则的对象。
    WEAK：弱引用，更积极地移除基于垃圾回收器状态和弱引用规则的对象。
    默认是 LRU
flushInterval：缓存刷新间隔。
    缓存多长时间清空一次，默认不清空，设置一个毫秒值。
readOnly：是否只读
    false：非只读。mybatis认为获取的数据可能会被修改。
            mybatis会利用序列化和反序列化的技术克隆一份新的数据给你。安全，速度慢。
    true：只读。mybatis认为所有从缓存中获取数据的操作都是只读操作，不会修改数据。
          mybatis为了加快获取速度，直接就会将数据在缓存中的引用交给用户。不安全，速度快
size：缓存存放多少元素。
type：指定自定义缓存的全类名。实现Cache接口即可。</code></pre><p>3.我们的pojo需要实现序列化接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dept</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br></pre></td></tr></table></figure>

<p>4.测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSecondLevelCache</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        InputStream inputStream =Resources.getResourceAsStream(<span class="string">"mybatis.xml"</span>);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory= <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        <span class="comment">//两个不同的会话</span></span><br><span class="line">        SqlSession openSession = sqlSessionFactory.openSession();</span><br><span class="line">        SqlSession openSession1 = sqlSessionFactory.openSession();</span><br><span class="line">        DepartmentMapper mapper = openSession.getMapper(DepartmentMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        DepartmentMapper mapper1 = openSession1.getMapper(DepartmentMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">        Dept deptById = mapper.getDeptById(<span class="string">"1"</span>);</span><br><span class="line">        System.out.println(deptById);</span><br><span class="line">        <span class="comment">//只有第一次会话关闭了，才会有二级缓存</span></span><br><span class="line">        openSession.close();</span><br><span class="line">		<span class="comment">//第二次查询是从二级缓存中拿到的数据，并没有发送新的sql</span></span><br><span class="line">        Dept deptById1 = mapper1.getDeptById(<span class="string">"1"</span>);</span><br><span class="line">        System.out.println(deptById1);</span><br><span class="line">        openSession.close();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1594804904720.png" alt="1594804904720" style="zoom:80%;">

<p>只发了一个sql。</p>
<h3 id="4-缓存有关的设置及属性"><a href="#4-缓存有关的设置及属性" class="headerlink" title="4.缓存有关的设置及属性"></a>4.缓存有关的设置及属性</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"cacheEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">1.cacheEnabled：</span><br><span class="line">    true:开启二级缓存</span><br><span class="line">    false(关闭二级缓存，一级缓存一直可以用)</span><br><span class="line">2.useCache：每个select标签中都有userCache标签</span><br><span class="line">	value="true" 一级二级缓存都会使用</span><br><span class="line">		   false:不会使用二级缓存</span><br><span class="line">*3.flushCache：每一个增删改标签中都有清空缓存，默认为true</span><br><span class="line">	true：增删改执行完成后就会清除一级缓存，二级缓存也会被清空；</span><br><span class="line">	在select标签中默认为 false；</span><br><span class="line">4.sqlSession.clearCache();  清除当前session的一级缓存</span><br><span class="line">5.localCacheScope：本地缓存作用域（一级缓存session）</span><br></pre></td></tr></table></figure>

<p><img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1594819367042.png" alt="1594819367042"></p>
<p><img src="/2020/02/11/Mybatis2/D:%5CProgram_Files%5CChenZhixia-stu%5Csource%5C_posts%5CMybatis2%5C1594822620064.png" alt="1594822620064"></p>
<h3 id="5-mybatis整合ehcache"><a href="#5-mybatis整合ehcache" class="headerlink" title="5.mybatis整合ehcache"></a>5.mybatis整合ehcache</h3><p>第三方整合：</p>
<p>​        导入第三方缓存包，也可以在pom文件中导入依赖</p>
<p>​        导入与第三方缓存整合的适配包（官方有）</p>
<p>​        mapper.xml文件中使用自定义缓存：    </p>
<p>​                  <cache type="org.mybatis.caches.ehcache.EhcacheCache"></cache></p>
<p>1.导入以下依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.ehcache<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ehcache<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.30<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.25<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.caches<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-ehcache<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2.在mapper.xml文件中的mapper标签中</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">cache</span> <span class="attr">type</span>=<span class="string">"org.mybatis.caches.ehcache.EhcacheCache"</span>&gt;</span><span class="tag">&lt;/<span class="name">cache</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>3.</p>
<p>引用缓存  namespace：制定和哪个名称空间下的缓存一样</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">cache-ref</span> <span class="attr">namespace</span>=<span class="string">"com.ecjtu.mapper.DynamicSQL"</span>&gt;</span><span class="tag">&lt;/<span class="name">cache-ref</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="五-MyBatis-Spring整合"><a href="#五-MyBatis-Spring整合" class="headerlink" title="五.MyBatis-Spring整合"></a>五.MyBatis-Spring整合</h1>
    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/author-czx/" rel="tag"># author-czx</a>
              <a href="/tags/Mybatis/" rel="tag"># Mybatis</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/02/11/Spring-Boot/" rel="prev" title="Springboot">
      <i class="fa fa-chevron-left"></i> Springboot
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/02/11/Tomcat%E7%9A%84%E5%86%8D%E6%AC%A1%E8%AE%A4%E8%AF%86/" rel="next" title="Tomcat的再次认识">
      Tomcat的再次认识 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#一-Mybatis简介"><span class="nav-number">1.</span> <span class="nav-text">一.Mybatis简介</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#二-IDEA创建mybatis项目"><span class="nav-number">2.</span> <span class="nav-text">二.IDEA创建mybatis项目</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-项目创建-接口式编程"><span class="nav-number">2.1.</span> <span class="nav-text">1.项目创建 接口式编程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-配置文件"><span class="nav-number">2.2.</span> <span class="nav-text">2.配置文件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-在pom-xml文件中添加依赖，build"><span class="nav-number">2.2.1.</span> <span class="nav-text">1.在pom.xml文件中添加依赖，build</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-log4j日志添加"><span class="nav-number">2.2.2.</span> <span class="nav-text">2.log4j日志添加</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-resource目录下配置文件添加"><span class="nav-number">2.2.3.</span> <span class="nav-text">3.resource目录下配置文件添加</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-编写User实体类"><span class="nav-number">2.2.4.</span> <span class="nav-text">4.编写User实体类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-SQL映射文件UserMapper-xml"><span class="nav-number">2.2.5.</span> <span class="nav-text">5.SQL映射文件UserMapper.xml</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-编写接口UserMapper"><span class="nav-number">2.2.6.</span> <span class="nav-text">6.编写接口UserMapper</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-测试"><span class="nav-number">2.2.7.</span> <span class="nav-text">7.测试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-小结"><span class="nav-number">2.2.8.</span> <span class="nav-text">8.小结</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#三-mybatis-xml全局配置文件"><span class="nav-number">3.</span> <span class="nav-text">三.mybatis.xml全局配置文件</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-properties（了解）"><span class="nav-number">3.1.</span> <span class="nav-text">1.properties（了解）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-settings设置"><span class="nav-number">3.2.</span> <span class="nav-text">2.settings设置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-typeAliases别名处理器"><span class="nav-number">3.3.</span> <span class="nav-text">3.typeAliases别名处理器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-单个起别名"><span class="nav-number">3.3.1.</span> <span class="nav-text">1.单个起别名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-批量起别名"><span class="nav-number">3.3.2.</span> <span class="nav-text">2.批量起别名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-别名注解"><span class="nav-number">3.3.3.</span> <span class="nav-text">3.别名注解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-typeHandlers-类型处理器（后补）"><span class="nav-number">3.4.</span> <span class="nav-text">4.typeHandlers 类型处理器（后补）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-plugin插件（后补）"><span class="nav-number">3.5.</span> <span class="nav-text">5.plugin插件（后补）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-environments环境配置（了解）"><span class="nav-number">3.6.</span> <span class="nav-text">6.environments环境配置（了解）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-databaseIdProvider数据库厂商标识"><span class="nav-number">3.7.</span> <span class="nav-text">7.databaseIdProvider数据库厂商标识</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-为不同厂商的数据库起别名"><span class="nav-number">3.7.1.</span> <span class="nav-text">1.为不同厂商的数据库起别名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-切换环境测试"><span class="nav-number">3.7.2.</span> <span class="nav-text">2.切换环境测试</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-mappers映射器"><span class="nav-number">3.8.</span> <span class="nav-text">8.mappers映射器</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#四-映射文件"><span class="nav-number">4.</span> <span class="nav-text">四.映射文件</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-测试增删改查"><span class="nav-number">4.1.</span> <span class="nav-text">1.测试增删改查</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-insert获取自增主键的值（粗略）"><span class="nav-number">4.2.</span> <span class="nav-text">2.insert获取自增主键的值（粗略）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-参数处理"><span class="nav-number">4.3.</span> <span class="nav-text">3.参数处理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-单个参数："><span class="nav-number">4.3.1.</span> <span class="nav-text">1.单个参数：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-多个参数："><span class="nav-number">4.3.2.</span> <span class="nav-text">2.多个参数：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-命名参数"><span class="nav-number">4.3.3.</span> <span class="nav-text">3.命名参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-POJO-amp-Map-amp-TO"><span class="nav-number">4.3.4.</span> <span class="nav-text">4.POJO&amp;Map&amp;TO</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-参数处理拓展"><span class="nav-number">4.3.5.</span> <span class="nav-text">5.参数处理拓展</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-与-取值区别"><span class="nav-number">4.3.6.</span> <span class="nav-text">6.$与#取值区别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-更丰富的用法"><span class="nav-number">4.3.7.</span> <span class="nav-text">7.#{}更丰富的用法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-select"><span class="nav-number">4.4.</span> <span class="nav-text">4.select</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-返回值类型List"><span class="nav-number">4.4.1.</span> <span class="nav-text">1.返回值类型List</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-记录封装Map"><span class="nav-number">4.4.2.</span> <span class="nav-text">2.记录封装Map</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-resultMap"><span class="nav-number">4.4.3.</span> <span class="nav-text">3.resultMap</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-关联查询-级联属性封装结果"><span class="nav-number">4.4.4.</span> <span class="nav-text">4.关联查询_级联属性封装结果</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-关联查询-association定义关联对象封装规则"><span class="nav-number">4.4.5.</span> <span class="nav-text">5.关联查询 association定义关联对象封装规则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-association分步查询"><span class="nav-number">4.4.6.</span> <span class="nav-text">6.association分步查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-延迟加载"><span class="nav-number">4.4.7.</span> <span class="nav-text">7.延迟加载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-collection定义关联集合封装规则"><span class="nav-number">4.4.8.</span> <span class="nav-text">8.collection定义关联集合封装规则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-collection分步查询"><span class="nav-number">4.4.9.</span> <span class="nav-text">9.collection分步查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10-将多列的值传递和fetchType"><span class="nav-number">4.4.10.</span> <span class="nav-text">10.将多列的值传递和fetchType</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#11-discriminator鉴别器"><span class="nav-number">4.4.11.</span> <span class="nav-text">11.discriminator鉴别器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-动态SQL"><span class="nav-number">4.5.</span> <span class="nav-text">5.动态SQL</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-where标签"><span class="nav-number">4.5.1.</span> <span class="nav-text">1.where标签</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-chose-标签-分支选择-：switch-case"><span class="nav-number">4.5.2.</span> <span class="nav-text">2.chose 标签 分支选择 ：switch-case</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-set-更新"><span class="nav-number">4.5.3.</span> <span class="nav-text">3.set  更新</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-foreach批量查询"><span class="nav-number">4.5.4.</span> <span class="nav-text">4.foreach批量查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-foreach批量插入"><span class="nav-number">4.5.5.</span> <span class="nav-text">5.foreach批量插入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-内置参数-parameter-amp-databaseId"><span class="nav-number">4.5.6.</span> <span class="nav-text">6.内置参数 _parameter &amp; _databaseId</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-bind绑定"><span class="nav-number">4.5.7.</span> <span class="nav-text">7.bind绑定</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-sql-抽取可重用的sql片段"><span class="nav-number">4.5.8.</span> <span class="nav-text">8. sql 抽取可重用的sql片段</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-缓存机制"><span class="nav-number">4.6.</span> <span class="nav-text">6.缓存机制</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-一级缓存体验"><span class="nav-number">4.6.1.</span> <span class="nav-text">1.一级缓存体验</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-一级缓存失效的四种情况"><span class="nav-number">4.6.2.</span> <span class="nav-text">2.一级缓存失效的四种情况</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-二级缓存介绍"><span class="nav-number">4.6.3.</span> <span class="nav-text">3.二级缓存介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-缓存有关的设置及属性"><span class="nav-number">4.6.4.</span> <span class="nav-text">4.缓存有关的设置及属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-mybatis整合ehcache"><span class="nav-number">4.6.5.</span> <span class="nav-text">5.mybatis整合ehcache</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#五-MyBatis-Spring整合"><span class="nav-number">5.</span> <span class="nav-text">五.MyBatis-Spring整合</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="’小伙子"
      src="/images/66.jpg">
  <p class="site-author-name" itemprop="name">’小伙子</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">13</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/ChenZhixia-stu" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ChenZhixia-stu" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:1760405308@qq.com" title="E-Mail → mailto:1760405308@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title">
      <i class="fa fa-fw fa-link"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://music.163.com/#/user/home?id=411741257" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;411741257" rel="noopener" target="_blank">网易云音乐</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">’小伙子</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.7.1
  </div>

        






  <script>
  function leancloudSelector(url) {
    url = encodeURI(url);
    return document.getElementById(url).querySelector('.leancloud-visitors-count');
  }
  if (CONFIG.page.isPost) {
    function addCount(Counter) {
      var visitors = document.querySelector('.leancloud_visitors');
      var url = decodeURI(visitors.getAttribute('id'));
      var title = visitors.getAttribute('data-flag-title');

      Counter('get', `/classes/Counter?where=${JSON.stringify({ url })}`)
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            var counter = results[0];
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .then(response => response.json())
              .then(() => {
                leancloudSelector(url).innerText = counter.time + 1;
              })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              })
          } else {
              leancloudSelector(url).innerText = 'Counter not initialized! More info at console err msg.';
              console.error('ATTENTION! LeanCloud counter has security bug, see how to solve it here: https://github.com/theme-next/hexo-leancloud-counter-security. \n However, you can still use LeanCloud without security, by setting `security` option to `false`.');
            
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }
  } else {
    function showTime(Counter) {
      var visitors = document.querySelectorAll('.leancloud_visitors');
      var entries = [...visitors].map(element => {
        return decodeURI(element.getAttribute('id'));
      });

      Counter('get', `/classes/Counter?where=${JSON.stringify({ url: { '$in': entries } })}`)
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length === 0) {
            document.querySelectorAll('.leancloud_visitors .leancloud-visitors-count').forEach(element => {
              element.innerText = 0;
            });
            return;
          }
          for (let item of results) {
            let { url, time } = item;
            leancloudSelector(url).innerText = time;
          }
          for (let url of entries) {
            var element = leancloudSelector(url);
            if (element.innerText == '') {
              element.innerText = 0;
            }
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }
  }

  fetch('https://app-router.leancloud.cn/2/route?appId=')
    .then(response => response.json())
    .then(({ api_server }) => {
      var Counter = (method, url, data) => {
        return fetch(`https://${api_server}/1.1${url}`, {
          method: method,
          headers: {
            'X-LC-Id'     : '',
            'X-LC-Key'    : '',
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    });
  </script>


      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
  <script src="//cdn.jsdelivr.net/npm/quicklink@1/dist/quicklink.umd.js"></script>
  <script>
      window.addEventListener('load', () => {
      quicklink({
        timeout: 3000,
        priority: true,
        ignores: [uri => uri.includes('#'),uri => uri == 'http://yoursite.com/2020/02/11/Mybatis2/',]
      });
      });
  </script>

</body>
</html>
